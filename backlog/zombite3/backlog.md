# Backlog: zombite3

> Generated by `aitri plan`.
> Spec-driven rule: every story MUST reference one or more Functional Rules (FR-*) and, when applicable, Acceptance Criteria (AC-*).
> Discovery rigor profile: standard.
> Planning rule: Keep one hardening story in the first sprint to close remaining discovery gaps.
> Quality profile: Game/Interactive (game).
> Domain constraint: Use a rendering/game engine (for example Phaser or Three.js). Avoid raw primitive-only canvas logic as architecture baseline.
> Asset strategy: Use external asset loading (sprites/GLTF/audio) with public-domain packs or placeholders and document fallback behavior.
> Story contract: Stories must specify concrete player/system actors and acceptance criteria should follow Given/When/Then.

## Epics
- EP-1: Run Locally With Npm Install + Npm Run Dev And Provide A Fully Playable Fixed-camera Gallery-shooter Loop Where Each Wave Spawns Zombies And Civilians Together, And Left-click Shots Are Resolved From The Crosshair So Zombies Are Rewarded And Civilians Are Penalized Immediately with verified coverage
  - Notes: Covers 2 story slice(s) with explicit acceptance traces.
  - Trace: FR-1, FR-2

## User Stories

### US-1
- As a Single player (public audience playtest/demo users)., I want run locally with npm install + npm run dev and provide a fully playable fixed-camera gallery-shooter loop where each wave spawns zombies and civilians together, and left-click shots are resolved from the crosshair so zombies are rewarded and civilians are penalized immediately, so that the workflow remains reliable and traceable.
- Trace: FR-1, AC-1
- Acceptance Criteria:
  - Given a running wave with at least one civilian visible, when the player left-clicks and hits that civilian, then score decreases by 50, player life decreases by 15 (or one equivalent strike as specified), and the game shows visual and audio penalty feedback immediately.

### US-2
- As a Single player (public audience playtest/demo users)., I want all final visual/audio assets must be real licensed assets with clear permissive licenses (CC0/MIT/Apache/equivalent), documented in ASSETS.md, and final enemies must not be emojis or placeholder geometric shapes, so that the workflow remains reliable and traceable.
- Trace: FR-2, AC-1
- Acceptance Criteria:
  - Given a running wave with at least one civilian visible, when the player left-clicks and hits that civilian, then score decreases by 50, player life decreases by 15 (or one equivalent strike as specified), and the game shows visual and audio penalty feedback immediately.

## Consolidated Spec Backlog (Zombie Rescue Runner)

### Epic: Camera and Scene Coherence
- Goal: Player understands goals in <5 seconds without tutorial.
- `TODO`: Keep camera fully fixed; mouse moves only crosshair.
- `TODO`: Remove cursor-linked world/parallax movement.
- `TODO`: Keep crosshair always above all entities.

### Epic: Grounded Visual Physics
- `TODO`: Maintain visible continuous ground plane (street/sidewalk) with clear foot contact line.
- `TODO`: Keep all ground entities anchored to shared lane floor references.
- `TODO`: Ground shadows for civilians/zombies/elite/brute only.
- `TODO`: No ground shadows for airborne power-ups.
- `TODO`: Shadow scale by lane depth (front 1.0, mid 0.85, back 0.7).

### Epic: Lane-Based Depth
- `TODO`: 3 fixed lanes (back/mid/front) with different Y and scale.
- `TODO`: Front scale 1.0, mid 0.85, back 0.7.
- `TODO`: Lane depth should reduce overlap ambiguity and friendly-fire confusion.

### Epic: Entity Behavior
- `TODO`: Civilians run to visible safe checkpoint/exit on opposite side.
- `TODO`: Zombie AI must never target mouse/crosshair.
- `TODO`: Zombies lock a civilian target on spawn and retarget only if target is gone.
- `TODO`: Civil danger indicator (`!` + short scream + blink) when threatened.

### Epic: Combat and Damage Rules
- `TODO`: Maintain 0.25s fire cooldown.
- `TODO`: Keep hit priority zombie over civilian on overlap.
- `TODO`: Civilian shot = -50 score and -15 life (`FRIENDLY FIRE` feedback).
- `TODO`: Civilian touched by zombie = -15 life and +1 lost civil.
- `TODO`: Game over on life <= 0 or lost-civil limit reached.

### Epic: Power-ups
- `TODO`: Airborne power-ups only (not confused with civilians).
- `TODO`: Health power-up = +20 life.
- `TODO`: Bonus power-up = +50 score and recover 1 lost civilian.

### Epic: Special Enemies and Level Identity
- `TODO`: Level 3 introduces Alpha zombie (bigger, faster, 3 hits).
- `TODO`: Level 5 introduces Brute/Monster (2x size, slower, 6 hits, HP bar).
- `TODO`: Brute reaching a civilian counts as 2 civilians lost.
- `TODO`: Increase power-up chance after elite/brute kills.
- `TODO`: Distinct level feel via spawn pressure and enemy mix.

### Epic: Feedback Priority
- Visual priority target order:
  1. Civilian in danger
  2. Brute
  3. Alpha
  4. Normal zombie
  5. Background
- `TODO`: Keep background contrast below active gameplay entities.

## Implementation Backlog Addendum — Final Design Doc

### Phase A: Camera and Scene Lock
- `IN PROGRESS`: Keep camera fully static with crosshair-only mouse movement.
- `IN PROGRESS`: Remove any world movement/parallax tied to cursor.
- `TODO`: Tune dusk palette for late-afternoon readability.

### Phase B: Evacuation Loop
- `IN PROGRESS`: Spawn civilians first and spawn their pursuer zombies 1–2 seconds later.
- `IN PROGRESS`: Prevent normal zombie-only waves (boss exceptions only).
- `IN PROGRESS`: Count civilian reaches at visible checkpoints as rescued.

### Phase C: Threat Behaviors
- `IN PROGRESS`: Keep zombie AI locked to civilian targets (never cursor).
- `IN PROGRESS`: Retarget zombies only when current civilian target is gone.
- `IN PROGRESS`: Keep civilian warning cues always-on (`!`, blink, scream).

### Phase D: Combat Contract
- `IN PROGRESS`: Fixed penalties (friendly fire: -50 score/-15 life; civilian lost: -15 life).
- `IN PROGRESS`: Keep 0.25s cooldown and zombie-priority overlap resolution.
- `IN PROGRESS`: Ensure level completion is rescue-goal based (not kill-goal).

### Phase E: Special Enemies
- `IN PROGRESS`: Level 3 Alpha (3 HP, bigger, faster).
- `IN PROGRESS`: Level 5 Brute (6 HP, 2x size, slow, 2-civil penalty, HP bar).
- `IN PROGRESS`: Increase near-term power-up chance after elite/brute kills.

## Implementation Backlog Addendum — Documento Final de Diseño

### Phase F: Camera and Scene Contract
- `DONE`: Camera fixed and crosshair-only mouse behavior.
- `DONE`: No cursor-linked parallax/world translation.
- `DONE`: Late-afternoon readable background palette.

### Phase G: Grounding and Lane Readability
- `DONE`: Recognizable sidewalk/asphalt split with visible curb line.
- `DONE`: Three lane depth system (back 0.7, mid 0.85, front 1.0).
- `DONE`: Contact shadows for all ground entities only (no power-up shadows).
- `TODO`: Final polish pass to ensure every lane foot contact reads at a glance on all resolutions.

### Phase H: Evacuation Loop
- `DONE`: Civilians spawn first.
- `DONE`: Pursuer zombies spawn 1–2s later per civilian.
- `DONE`: No normal zombie-only waves (boss exceptions only).
- `DONE`: Safe-zone checkpoints visible and used for rescue scoring.

### Phase I: Combat and Failure Clarity
- `DONE`: Crosshair 1:1 aiming with 0.25s cooldown.
- `DONE`: Overlap priority favors zombies over civilians.
- `DONE`: Friendly fire applies -50 score / -15 life with explicit feedback.
- `DONE`: Zombie touch applies civilian loss and life penalty with danger feedback.

### Phase J: Enemy Tiers and Power-ups
- `DONE`: Normal zombie (1 hit), Alpha (L3, 3 hits), Brute (L5, 6 hits + HP bar).
- `DONE`: Brute contact counts as double civilian loss.
- `DONE`: Airborne health/bonus power-ups with visual separation from civilians.
- `DONE`: Higher short-term power-up pressure relief after elite/brute kills.

## Implementation Backlog Addendum — Documento Técnico 2026-02-18

### Phase K: Scene Realism and Readability
- `DONE`: Daytime city layer with moving clouds and desaturated building parallax.
- `DONE`: Sidewalk/asphalt separation with visible curb line.
- `DONE`: Military bunker safe-zone on the right edge.
- `DONE`: Ground shadows for all grounded entities.

### Phase L: Combat and Threat Rules
- `DONE`: Danger trigger adjusted to 100px for civilian warning.
- `DONE`: Zombie impact feedback includes white flash and red pixel particles.
- `DONE`: Contact damage by zombie type (normal/alpha/brute) implemented.
- `DONE`: Brute contact reduces saved civilians by 2.

### Phase M: UX and Platform
- `DONE`: Landscape orientation guard with rotate-device prompt in portrait.
- `DONE`: HUD includes persistent high score from localStorage.

### Phase N: Architectural Gap Tracking
- `DONE`: Optional migration plan to pure Canvas API documented in `/docs/CANVAS_PURE_MIGRATION_PLAN.md`.
- `DONE`: Object pooling for runtime entities.
- `DONE`: Zombie visuals pooled (sprite/shadow/hp-bars) to reduce create/destroy churn.
- `DONE`: Civilian visuals pooled (sprite/shadow/danger icon).
- `DONE`: Shot tracer effects pooled as lightweight projectile representation.
- `DONE`: Generic particle effects pooled (hit + reward particles).
